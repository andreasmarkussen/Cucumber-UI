{"version":3,"names":[],"mappings":"","sources":["home/home-controller.js"],"sourcesContent":["(function() {\n\t'use strict';\n\n\t/**\n\t * @ngdoc object\n\t * @name home.controller:HomeCtrl\n\t * \n\t * @description\n\t * \n\t */\n\tangular.module('home').controller('HomeCtrl', HomeCtrl);\n\n\tfunction HomeCtrl($http, $aside,$uibModal,$log,$window,Socket,toastr) {\n\t\tvar vm = this;\n\t\tvm.ctrlName = 'HomeCtrl';\n\t\tvm.showLogPanel=false;\n\n\t\tthis.toggleModal = function(){\n\t        this.showModal = !this.showModal;\n\t    };\n\t    \n\t    vm.addNewScenario=function(){\n\t    \tvar scenario={\n\t\t    \t\tname:'Enter scenario name',\n\t\t    \t\tsteps:[]\n\t\t    \t}\n\t    \tvm.feature.scenarios.push(scenario)\n\t    \tvm.scenarioSelected=scenario;\n\t    \tvm.upload(vm.feature);\n\t    }\n\t    \n\t    vm.config={\n\t    \t\tbrowser:'phantomjs'\n\t    };\n\n\t    \n\t    vm.runFeature=function(featureName){\n\t    \tvm.message='';\n\t    \tvm.showReport=false;\n\t    \tvm.showLogsPanel=true;\n\t    \n\t    \tvar browser=vm.config.browser;\n\t    \t\n\t    \t$http.get('/steps/run?browser='+browser+'&feature='+featureName); \n\t    \t// $window.open('/steps/run?browser='+browser+'&feature='+featureName,'_blank',\n\t\t\t// 'width=800,height=600')\n\t    }\n\t    Socket.on('message', function (data) {\n\t    \tvm.message=vm.message+data.message\n\t    });\n\t    Socket.on('exit', function (data) {\n\t    \tvm.showReport=true;\n\t    });\n\t\t\n\t\tvm.addNewFeature=function(){\n\t\t\tvar modalInstance = $uibModal.open({\n\t\t\t      animation: true,\n\t\t\t      templateUrl: 'myModalContent.html',\n\t\t\t      controller: 'ModalInstanceCtrl',\n\t\t\t      size: 'md'\n\t\t\t    });\n\n\t\t\t    modalInstance.result.then(function (name) {\n\t\t\t      console.log(name)\n\t\t\t      vm.features[name]={\n\t\t\t  \t\t\tname : name,\n\t\t\t\t\t\tdescription : 'Feature Description',\n\t\t\t\t\t\tscenarios : [ {\n\t\t\t\t\t\t\tname : 'Scenarion Name',\n\t\t\t\t\t\t\tsteps : []\n\t\t\t\t\t\t} ]\n\t\t\t\t  }\n\t\t\t      \n\t\t\t      vm.feature=vm.features[name];\n\t\t\t      \n\t\t\t      vm.upload(vm.feature);\n\t\t\t      \n\t\t\t    }, function () {\n\t\t\t      $log.info('Modal dismissed at: ' + new Date());\n\t\t\t    });\n\t\t}\n\t\t\n\t\tvm.showConf = function() {\n\t\t\tvar asideInstance = $aside.open({\n\t\t\t\ttemplateUrl : 'home/right-aside.tpl.html',\n\t\t\t\tcontrollerAs:'rightAside',\n\t\t\t\tcontroller:'RightAsideCtrl',\n\t\t\t\tplacement : 'right',\n\t\t\t\tsize : 'md',\n\t\t\t\tresolve:{\n\t\t\t\t\tfeatureName:function(){\n\t\t\t\t\t\treturn vm.feature.name;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\n\t\t$http.get('/steps').then(function(res) {\n\t\t\tvm.steps = res.data.steps;\n\t\t\tvm.features=res.data.features;\n\t\t\tvm.feature=vm.features[Object.keys(vm.features)[0]];\n\t\t\t// vm.showConf()\n\t\t\t\n\t\t})\n\n\t\tvm.addMoreScenario = function() { \n\t\t\tvar scenario={\n\t\t\t\t\tname : 'Enter Scenario Name',\n\t\t\t\t\tsteps : []\n\t\t\t};\n\t\t\t// vm.feature.scenarios.push(scenario);\n\t\t\t\n\t\t\tvm.scenarioSelected=scenario;\n\t\t\tvm.upload(vm.feature);\n\t\t}\n\n\t\tvm.upload = function(feature) {\n\t\t\t\n\t\t\t$http.post('/steps/export', {\n\t\t\t\tfeature : feature\n\t\t\t}).then(function(res) {\n\t\t\t\tconsole.log(res.data)\n\t\t\t\ttoastr.success('Feature saved!');\n\t\t\t})\n\t\t}\n\t\t\n\t\tvm.deleteFeature=function(feature){\n\t\t\tconsole.log(feature);\n\t\t\t$http.delete('/steps/export', {\n\t\t\t\tparams:{\n\t\t\t\t\tname:feature.name\n\t\t\t\t}\n\t\t\t}).then(function(res) {\n\t\t\t\tdelete vm.features[feature.name];\n\t\t\t\tif(vm.feature.name=feature.name){\n\t\t\t\t\tvm.feature=vm.features[Object.keys(vm.features)[0]];\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t\t\n\t\tvm.deleteScenario=function(scenario){\n\t\t\tvar x=vm.feature.scenarios.indexOf(scenario)\n\t\t\tvm.feature.scenarios.splice(x,1);\n\t\t\tvm.upload(vm.feature);\n\t\t}\n\t}\n}());\n"],"file":"home/home-controller.js","sourceRoot":"/source/"}